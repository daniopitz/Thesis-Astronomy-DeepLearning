% \RequirePackage{iftex}
% \ifPDFTeX
%   \errmessage{This document requires XeLaTeX or LuaLaTeX. Please change your compiler.}
% \fi
\documentclass[12pt]{report}

% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@>
% VALORES A MODIFICAR POR USTED:
% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@>

% NOTE: Leer nota en el README sobre la font.
\newcommand{\titulo}{DRAFTS++: Extensión Productiva del Sistema DRAFTS para Detección y Clasificación de Transientes de Radio desde Bajas hasta Altas Frecuencias}
% \newcommand{\titulo}{Extensión del pipeline DRAFTS mediante DRAFTS++: detección de transitorios rápidos de radio en el dominio milimétrico con ALMA}
\newcommand{\ciudad}{Valparaíso} % e.g. Valparaíso
% TODO: Consultar el formato de los nombres:
\newcommand{\nombrealumno}{Sebastian Salgado Polanco}
\newcommand{\nombreprofesor}{Daniela Opitz}
\newcommand{\nombrecorreferente}{Marylin Cruces}
% Mes y año del examen
\newcommand{\mesexamen}{Enero}
\newcommand{\anioexamen}{2025}
% Dedicatoria y agradecimientos
\newcommand{\dedicatoria}{
Considerando lo importancia de este trabajo para los alumnos, este apartado es para que el autor entregue palabras personales para dedicar este documento. La extensión puede ser de máximo una hoja y se deben mantener este formato, tipo y tamaño de letra.
}
\newcommand{\agradecimientos}{
Considerando la importancia de este trabajo para los alumnos, este apartado se podrá incluir en el caso de que el autor desee agradecer a las personas que facilitaron alguna ayuda relevante en su trabajo para la realización de este documento. La extensión puede ser de máximo una hoja y se deben mantener este formato, tipo y tamaño de letra.
}
\newcommand{\resumen}{
La detección de Fast Radio Bursts (FRBs) enfrenta dos desafíos metodológicos críticos. En frecuencias bajas (LF, 0.3--8 GHz), pipelines tradicionales generan miles de candidatos con $>99\%$ falsos positivos, haciendo inviable la curaduría manual ante volúmenes masivos de datos. Aunque DRAFTS demuestra viabilidad conceptual mediante deep learning (CenterNet + ResNet18), permanece como prototipo sin infraestructura operacional: carece de gestión robusta de memoria, manejo multi-formato, y continuidad temporal verificada. En frecuencias milimétricas (HF, 30--100 GHz), la firma dispersiva característica (patrón ``bow-tie'') se comprime hasta volverse imperceptible, eliminando la base de algoritmos convencionales desarrollados para frecuencias centimétricas.

Esta tesis propone \textbf{DRAFTS++}, un pipeline astronómico operativo estructurado en dos componentes complementarios. El \textbf{Componente 1} desarrolla infraestructura de software robusta mediante ingeniería rigurosa: pipeline end-to-end modular con procesamiento en streaming, gestión inteligente de memoria, ingesta multi-formato automática, y orquestación automatizada de modelos pre-entrenados. El \textbf{Componente 2} extiende el sistema al régimen milimétrico mediante el modo HF-PoL (High-Frequency Polarization-Linear), que combina matched filtering temporal con clasificación dual CNN en intensidad y polarización lineal mediante ResNet18 pre-entrenado, sin reentrenamiento.

Los resultados validan empíricamente ambos componentes. En LF, el sistema alcanza 97.3\% de recall (732/752 pulsos) en observaciones del púlsar B0355+54, validando robustez temporal y continuidad sin pérdidas en bordes de chunks. En FRB 121102, logra recall 100\% recuperando los 24 eventos conocidos y descubriendo 2 nuevos bursts confirmados. En HF (86 GHz ALMA), la Línea 2b alcanza precision $\sim$100\% reduciendo falsos positivos en 94.1\% (102 $\rightarrow$ 6 candidatos) y descubre 44 pulsos nuevos del magnetar PSR J1745-2900.

La contribución metodológica principal es la demostración empírica de que el \textbf{transfer learning falla en intensidad pero triunfa en polarización}: la Línea 2a (clasificación solo en I) logra recall 100\% pero precision 37.3\%, mientras que la Línea 2b (clasificación dual I+L) transforma el sistema en productivo (precision $\sim$100\%) validando que pulsos astrofísicos genuinos exhiben coherencia morfológica entre polarizaciones mientras RFI muestra discrepancia. Este hallazgo, combinado con la transformación de un prototipo en pipeline operativo reproducible, constituye la contribución de mayor impacto científico y técnico de esta tesis.
}
\newcommand{\resumeningles}{
The detection of Fast Radio Bursts (FRBs) faces two critical methodological challenges. At low frequencies (LF, 0.3--8 GHz), traditional pipelines generate thousands of candidates with $>99\%$ false positives, making manual curation unfeasible given massive data volumes. Although DRAFTS demonstrates conceptual viability through deep learning (CenterNet + ResNet18), it remains a research prototype without operational infrastructure: it lacks robust memory management, multi-format handling, and verified temporal continuity. At millimeter frequencies (HF, 30--100 GHz), the characteristic dispersive signature (``bow-tie'' pattern) compresses until it becomes imperceptible, eliminating the foundation of conventional algorithms developed for centimeter frequencies.

This thesis proposes \textbf{DRAFTS++}, an operational astronomical pipeline structured in two complementary components. \textbf{Component 1} develops robust software infrastructure through rigorous engineering: modular end-to-end pipeline with streaming processing, intelligent memory management, automatic multi-format ingestion, and automated orchestration of pre-trained models. \textbf{Component 2} extends the system to the millimeter regime through the HF-PoL (High-Frequency Polarization-Linear) mode, which combines temporal matched filtering with dual CNN classification in intensity and linear polarization using pre-trained ResNet18, without retraining.

Results empirically validate both components. In LF, the system achieves 97.3\% recall (732/752 pulses) in observations of pulsar B0355+54, validating temporal robustness and continuity without losses at chunk boundaries. In FRB 121102, it achieves 100\% recall recovering the 24 known events and discovering 2 new confirmed bursts. In HF (86 GHz ALMA), Line 2b achieves $\sim$100\% precision reducing false positives by 94.1\% (102 $\rightarrow$ 6 candidates) and discovers 44 new pulses from magnetar PSR J1745-2900.

The main methodological contribution is the empirical demonstration that \textbf{transfer learning fails in intensity but succeeds in polarization}: Line 2a (classification only in I) achieves 100\% recall but 37.3\% precision, while Line 2b (dual I+L classification) transforms the system into a productive one ($\sim$100\% precision) validating that genuine astrophysical pulses exhibit morphological coherence between polarizations while RFI shows discrepancy. This finding, combined with the transformation of a prototype into a reproducible operational pipeline, constitutes the contribution of greatest scientific and technical impact of this thesis.
}
\newcommand{\palabrasclave}{
Fast Radio Bursts; Transfer Learning; Radioastronomía; Pipeline de Detección; Polarización Lineal
}
\newcommand{\palabrasclaveingles}{
Fast Radio Bursts; Transfer Learning; Radio Astronomy; Detection Pipeline; Linear Polarization
}
% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@>

% Paquete para importar imágenes
\usepackage{graphicx}
% Directorio de las imágenes
\graphicspath{ {figures/} }

% Idioma y fuentes
\usepackage[utf8]{inputenc}
\usepackage[spanish,es-tabla]{babel}
\usepackage[T1]{fontenc}
\usepackage{lmodern} % Latin Modern fonts para pdfLaTeX

% Paquete para definir cualquier tamaño de font
\usepackage{anyfontsize}

% Tamaño de la página y márgenes
\usepackage[letterpaper,top=2.5cm,bottom=3cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Determinar interlineado:
\renewcommand{\baselinestretch}{1.0}

% Eliminar sangrías:
\setlength{\parindent}{0cm}

% Paquete para definir los formatos de los títulos
\usepackage[explicit]{titlesec}

\titleformat{name=\section}[block]{\fontsize{16}{24}\selectfont\bfseries}{}{0pt}{#1}
\titleformat{name=\section,numberless}[block]{\fontsize{16}{24}\selectfont\bfseries}{}{0pt}{#1}
\titlespacing*{name=\section}{0pt}{0pt}{0.5cm}
\titlespacing*{name=\section,numberless}{0pt}{0pt}{0.5cm}

% Formato para subsecciones numeradas
\titleformat{name=\subsection}[block]{\fontsize{14.4}{18}\selectfont\bfseries}{\arabic{mychapter}.\arabic{subsection}}{0.5em}{#1}
\titlespacing*{name=\subsection}{0pt}{0pt}{0.3cm}

% Formato para subsubsecciones numeradas
\titleformat{name=\subsubsection}[block]{\fontsize{12.96}{16}\selectfont\bfseries}{\arabic{mychapter}.\arabic{subsection}.\arabic{subsubsection}}{0.5em}{#1}
\titlespacing*{name=\subsubsection}{0pt}{0pt}{0.2cm}

% Separación entre parrafos
\setlength{\parskip}{0.4cm}

% Paquetes de utilidad general
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{float}
\usepackage{booktabs}  % Para comandos de tablas profesionales (\toprule, \midrule, \bottomrule)
\usepackage[table]{xcolor}  % Para colorear filas y columnas en tablas
\usepackage{tikz}       % Para diagramas y gráficos
\usepackage{pgfplots}   % Para gráficos (e.g., curvas \nu^{-2})
\pgfplotsset{compat=1.18}
\usetikzlibrary{positioning,shapes.geometric,arrows.meta}
\usepackage{adjustbox}  % Para redimensionar entornos (p.ej., TikZ) de forma segura
\usepackage{algorithm}  % Para pseudocódigos
\usepackage{algpseudocode}  % Para pseudocódigos con estilo
\usepackage{multicol}   % Para bibliografía en dos columnas

% Configuración profesional para captions de figuras y tablas
\usepackage[
  font=small,              % Letra más pequeña que el texto principal
  labelfont=bf,            % Etiqueta "Figura X.Y" en negrita
  textfont=it,             % Texto del caption en itálica
  justification=justified, % Justificado para mejor presentación
  skip=10pt,               % Espaciado entre figura y caption
  position=bottom          % Caption debajo de la figura
]{caption}

% Espaciado adicional alrededor de figuras para distinguirlas del texto
\setlength{\intextsep}{15pt plus 3pt minus 2pt}   % Espacio arriba/abajo de figuras
\setlength{\textfloatsep}{15pt plus 3pt minus 2pt} % Espacio para floats en top/bottom

% Configuración para algoritmos (ya están definidos por algpseudocode)
\usepackage{listings}   % Para código con formato
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage[round]{natbib}

% Formato de las tablas de contenido
\usepackage{tocbasic}

%% Originalmente se usaba tocstyle en vez de tocbasic.
%% Si se quiere usar, descomentar:
% \usepackage[tocflat]{tocstyle}
% \usetocstyle{allwithdot}
%% tocstyle.sty se obtener de https://github.com/firemodels/fds/blob/master/Manuals/LaTeX_Style_Files/tocstyle.sty

% Para obtener el número de la última página
\usepackage{lastpage}

% Header y footer
\usepackage{fancyhdr}
\setlength{\headheight}{25pt}
\fancypagestyle{portada}{
    \lhead{}
    \chead{}
    \rhead{}
    \lfoot{}
    \cfoot{\fontsize{10}{12}\selectfont \thepage}
    \rfoot{}
    \renewcommand{\headrulewidth}{0pt}
}
\fancypagestyle{intermedio}{
    \lhead{}
    \chead{\fontsize{10}{12}\selectfont\MakeUppercase{\titulo}}
    \rhead{}
    \lfoot{}
    \cfoot{\fontsize{10}{12}\selectfont Página \textbf{\thepage}\ de \textbf{\pageref{LastPage}}}
    \AtEndDocument{\label{LastPage}}
    \rfoot{}
    \renewcommand{\headrulewidth}{1pt}
}

% Numeración de secciones hasta subsubsecciones
\setcounter{secnumdepth}{3}  % Numerar hasta subsubsecciones
\setcounter{tocdepth}{3}     % Incluir subsubsecciones en tabla de contenidos

% Comandos para secciones
\newcounter{mychapter}
\setcounter{mychapter}{0}
\setcounter{section}{0}
\setcounter{figure}{0}
\setcounter{table}{0}
\newcommand{\secnumbersection}[1]{
\stepcounter{mychapter}
\stepcounter{section}
\phantomsection
\section*{CAPÍTULO \themychapter \texorpdfstring{\\}\ #1}
\addcontentsline{toc}{section}{CAPÍTULO \themychapter : #1}
\setcounter{subsection}{0}
\setcounter{figure}{0}
\setcounter{table}{0}
\renewcommand{\thesubsection}{\arabic{mychapter}.\arabic{subsection}}
}
\newcommand{\secnumberlesssection}[1]{
\section*{#1}
\phantomsection
\addcontentsline{toc}{section}{#1}
\setcounter{subsection}{0}
}

% Nombres
\addto\captionsspanish{\renewcommand{\contentsname}{ÍNDICE DE CONTENIDOS}}
\addto\captionsspanish{\renewcommand{\listfigurename}{ÍNDICE DE FIGURAS}}
\addto\captionsspanish{\renewcommand{\listtablename}{ÍNDICE DE TABLAS}}
\makeatletter
\renewenvironment{thebibliography}[1]
     {\secnumberlesssection{REFERENCIAS BIBLIOGRÁFICAS}
      \@mkboth{\MakeUppercase\bibname}{\MakeUppercase\bibname}%
      \small % Letra más pequeña para bibliografía
      \begin{multicols}{2} % Inicio de dos columnas
      \list{[\@arabic\c@enumiv]}% Numeración entre corchetes [1], [2], etc.
           {\settowidth\labelwidth{[#1]}% Ancho para números
            \leftmargin\labelwidth
            \advance\leftmargin\labelsep
            \itemsep=0.3em % Espaciado sutil entre referencias
            \parsep=0pt
            \@openbib@code
            \usecounter{enumiv}%
            \let\p@enumiv\@empty
            \renewcommand\theenumiv{\@arabic\c@enumiv}}%
      \sloppy
      \clubpenalty4000
      \@clubpenalty \clubpenalty
      \widowpenalty4000%
      \sfcode`\.\@m}
     {\def\@noitemerr
       {\@latex@warning{Empty `thebibliography' environment}}%
      \endlist
      \end{multicols}} % Fin de dos columnas
\makeatother

% Configuración de numeración de figuras y tablas
\renewcommand{\thefigure}{\arabic{mychapter}.\arabic{figure}}
\renewcommand{\thetable}{\arabic{mychapter}.\arabic{table}}

% Configuración para pseudocódigos con estilo profesional
\algnewcommand\algorithmicinput{\textbf{Entrada:}}
\algnewcommand\algorithmicoutput{\textbf{Salida:}}
\algnewcommand\Input{\item[\algorithmicinput]}
\algnewcommand\Output{\item[\algorithmicoutput]}

% Configuración de listings para código
\lstset{
    basicstyle=\ttfamily\small,
    keywordstyle=\bfseries,
    commentstyle=\itshape,
    stringstyle=\itshape,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    frame=single,
    breaklines=true,
    breakatwhitespace=true,
    tabsize=2,
    showstringspaces=false
}

% Personalizar Tabla de Contenidos

\usepackage{tocloft}
\renewcommand{\cftsecfont}{\fontsize{12}{14}\selectfont}
\renewcommand{\cftsubsecfont}{\fontsize{12}{14}\selectfont}
\renewcommand{\cftsubsubsecfont}{\fontsize{12}{14}\selectfont}

\renewcommand\cftfigfont{\fontsize{12}{14}\selectfont}

% Links sin color
\usepackage{hyperref}
\hypersetup{colorlinks = false}

% Comando para secciónes sin enumeración
% (sugerido por @anibalbastiass https://github.com/autopawn/tex-thesis-template/issues/5#issuecomment-916106128)
\newcommand{\secnumberlesssubsection}[1]{
\subsection*{#1}
\phantomsection
\addcontentsline{toc}{subsection}{#1}
\setcounter{subsection}{0}
}
% Forma de uso:
% \secnumberlesssubsection{"Sub seccion sin enumeración"}

% @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@>
\begin{document}
\sloppy % Para evitar que referencias se escapen de los márgenes.

\pagestyle{portada}
\pagenumbering{roman}
\input{portadas}

\newpage
\input{glosario}

%Índice de contenidos:
\newpage
\thispagestyle{portada}
\tableofcontents

%Índice de figuras:
\newpage
\thispagestyle{portada}
\phantomsection
\addcontentsline{toc}{section}{ÍNDICE DE FIGURAS}
\listoffigures
\phantomsection
\addcontentsline{toc}{section}{ÍNDICE DE TABLAS}
\listoftables

\newpage
\pagestyle{intermedio}
\pagenumbering{arabic}
\input{introduccion}

\newpage
\input{definicion_del_problema}
\newpage
\input{marco_conceptual}
\newpage
\input{propuesta_de_solucion}
\newpage
\input{validacion_de_la_solucion}
\newpage
\input{conclusiones}

\newpage
\input{anexos}

\newpage
% Bibliografía estilo APA:
\bibliographystyle{plainnat}
\bibliography{bibliografia}

\end{document}
